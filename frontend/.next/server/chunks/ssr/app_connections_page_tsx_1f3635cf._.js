module.exports=[63765,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(61162),e=a.i(62477),f=a.i(25707);let g=c.forwardRef(function({title:a,titleId:b,...d},e){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},d),a?c.createElement("title",{id:b},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}),h=c.forwardRef(function({title:a,titleId:b,...d},e){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},d),a?c.createElement("title",{id:b},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}),i=c.forwardRef(function({title:a,titleId:b,...d},e){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},d),a?c.createElement("title",{id:b},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))});var j=a.i(34079),k=a.i(95332),l=a.i(6878);function m(){let[a,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)("jira"),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)([]),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(""),P=async()=>{try{o(!0);let a=await e.api.getConnections();m(a)}catch(a){console.error("Failed to fetch connections",a)}finally{o(!1)}};(0,c.useEffect)(()=>{P()},[]),(0,c.useEffect)(()=>{if(L?.success){let a=setTimeout(()=>{M(null)},3e3);return()=>clearTimeout(a)}},[L]);let Q=async()=>{try{await e.api.createConnection({name:x,type:v}),q(!1),y(""),w("jira"),P()}catch(a){console.error("Failed to create connection",a),alert("Failed to create connection")}},R=async()=>{if(t)try{let a={jira_url:z,jira_email:B};"********"!==D&&(a.jira_api_token=D),await fetch(`${process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api"}/connections/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});let b=await fetch(`${process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api"}/connections/${t.id}/test`,{method:"POST"}),c=await b.json();if(M(c),c.success){let a=await fetch(`${process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api"}/connections/${t.id}/projects`),b=await a.json();I(b)}}catch(a){console.error("Test failed",a),M({success:!1,error:"Connection test failed"})}},S=async()=>{if(t)try{let a={jira_url:z,jira_email:B,jira_project_key:F,field_config:J};if("********"!==D&&(a.jira_api_token=D),await fetch(`${process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api"}/connections/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),F&&!J){let a=await fetch(`${process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api"}/connections/${t.id}/field-config`),b=await a.json();K(b);let c=Object.keys(b);c.length>0&&O(c[0])}alert("Configuration saved successfully!"),s(!1),P()}catch(a){console.error("Save failed",a),alert("Failed to save configuration")}},T=async a=>{if(confirm("Are you sure you want to delete this connection?"))try{await fetch(`${process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api"}/connections/${a}`,{method:"DELETE"}),P()}catch(a){console.error("Delete failed",a),alert("Failed to delete connection")}};return(0,b.jsxs)(d.MainLayout,{children:[(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsxs)("div",{className:"sm:flex sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{className:"sm:flex-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Connections"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-gray-700",children:"Configure integrations with JIRA and other data sources."})]}),(0,b.jsx)("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:(0,b.jsxs)("button",{onClick:()=>q(!0),className:"inline-flex items-center gap-x-2 rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500",children:[(0,b.jsx)(f.PlusIcon,{className:"-ml-0.5 h-5 w-5"}),"Add Connection"]})})]}),(0,b.jsx)("div",{className:"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:n?(0,b.jsx)("div",{className:"col-span-full text-center py-12",children:(0,b.jsx)("p",{className:"text-gray-500",children:"Loading connections..."})}):0===a.length?(0,b.jsx)("div",{className:"col-span-full text-center py-12",children:(0,b.jsx)("p",{className:"text-gray-500",children:'No connections yet. Click "Add Connection" to get started.'})}):a.map(a=>{var c;return(0,b.jsxs)("div",{className:"divide-y divide-gray-200 rounded-lg bg-white shadow",children:[(0,b.jsx)("div",{className:"flex w-full items-center justify-between space-x-6 p-6",children:(0,b.jsxs)("div",{className:"flex-1 truncate",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("h3",{className:"truncate text-sm font-medium text-gray-900",children:a.name}),"active"===(c=a.status)?(0,b.jsxs)("span",{className:"inline-flex items-center gap-x-1.5 rounded-md bg-green-100 px-2 py-1 text-xs font-medium text-green-700",children:[(0,b.jsx)(g,{className:"h-4 w-4"}),"Active"]}):"error"===c?(0,b.jsxs)("span",{className:"inline-flex items-center gap-x-1.5 rounded-md bg-red-100 px-2 py-1 text-xs font-medium text-red-700",children:[(0,b.jsx)(h,{className:"h-4 w-4"}),"Error"]}):(0,b.jsx)("span",{className:"inline-flex items-center gap-x-1.5 rounded-md bg-gray-100 px-2 py-1 text-xs font-medium text-gray-700",children:"Inactive"})]}),(0,b.jsx)("p",{className:"mt-1 truncate text-sm text-gray-500 capitalize",children:a.type}),a.jira_project_key&&(0,b.jsxs)("p",{className:"mt-1 truncate text-xs text-gray-400",children:["Project: ",a.jira_project_key]})]})}),(0,b.jsxs)("div",{className:"-mt-px flex divide-x divide-gray-200",children:[(0,b.jsx)("div",{className:"flex w-0 flex-1",children:(0,b.jsxs)("button",{onClick:()=>(a=>{if(u(a),A(a.jira_url||""),C(a.jira_email||""),E(a.has_api_token?"********":""),G(a.jira_project_key||""),K(a.field_config),a.field_config){let b=Object.keys(a.field_config);b.length>0&&O(b[0])}M(null),I([]),s(!0)})(a),className:"relative -mr-px inline-flex w-0 flex-1 items-center justify-center gap-x-3 rounded-bl-lg border border-transparent py-4 text-sm font-semibold text-gray-900 hover:text-indigo-600",children:[(0,b.jsx)(i,{className:"h-5 w-5"}),"Configure"]})}),(0,b.jsx)("div",{className:"-ml-px flex w-0 flex-1",children:(0,b.jsx)("button",{onClick:()=>T(a.id),className:"relative inline-flex w-0 flex-1 items-center justify-center gap-x-3 rounded-br-lg border border-transparent py-4 text-sm font-semibold text-gray-900 hover:text-red-600",children:"Delete"})})]})]},a.id)})})]}),(0,b.jsx)(k.Transition,{appear:!0,show:p,as:c.Fragment,children:(0,b.jsxs)(j.Dialog,{as:"div",className:"relative z-10",onClose:()=>q(!1),children:[(0,b.jsx)(k.Transition.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,b.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,b.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,b.jsx)(k.Transition.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,b.jsxs)(j.Dialog.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 shadow-xl transition-all",children:[(0,b.jsx)(j.Dialog.Title,{className:"text-lg font-medium leading-6 text-gray-900 mb-4",children:"Add New Connection"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium leading-6 text-gray-900",children:"Connection Name"}),(0,b.jsx)("input",{type:"text",value:x,onChange:a=>y(a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 text-gray-900",placeholder:"My JIRA Connection"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium leading-6 text-gray-900",children:"Source Type"}),(0,b.jsxs)("select",{value:v,onChange:a=>w(a.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 text-gray-900",children:[(0,b.jsx)("option",{value:"jira",children:"JIRA / Atlassian"}),(0,b.jsx)("option",{value:"email",children:"Email"}),(0,b.jsx)("option",{value:"slack",children:"Slack"}),(0,b.jsx)("option",{value:"teams",children:"Microsoft Teams"})]})]})]}),(0,b.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,b.jsx)("button",{onClick:Q,disabled:!x,className:"flex-1 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white hover:bg-indigo-500 disabled:bg-gray-300",children:"Create"}),(0,b.jsx)("button",{onClick:()=>q(!1),className:"flex-1 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"})]})]})})})})]})}),(0,b.jsx)(k.Transition,{appear:!0,show:r,as:c.Fragment,children:(0,b.jsxs)(j.Dialog,{as:"div",className:"relative z-10",onClose:()=>s(!1),children:[(0,b.jsx)(k.Transition.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,b.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,b.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,b.jsx)(k.Transition.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,b.jsxs)(j.Dialog.Panel,{className:"w-full max-w-3xl transform overflow-hidden rounded-2xl bg-white p-6 shadow-xl transition-all",children:[(0,b.jsxs)(j.Dialog.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:["Configure ",t?.name]}),(0,b.jsxs)(l.Tab.Group,{children:[(0,b.jsxs)(l.Tab.List,{className:"flex space-x-1 rounded-xl bg-blue-900/20 p-1 mb-6",children:[(0,b.jsx)(l.Tab,{className:({selected:a})=>`w-full rounded-lg py-2.5 text-sm font-medium leading-5 ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2 ${a?"bg-white text-blue-700 shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"}`,children:"Connection Settings"}),(0,b.jsx)(l.Tab,{className:({selected:a})=>`w-full rounded-lg py-2.5 text-sm font-medium leading-5 ring-white ring-opacity-60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2 ${a?"bg-white text-blue-700 shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"}`,children:"Field Configuration"})]}),(0,b.jsxs)(l.Tab.Panels,{children:[(0,b.jsx)(l.Tab.Panel,{children:(0,b.jsx)("div",{className:"space-y-4",children:t?.type==="jira"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"JIRA URL"}),(0,b.jsx)("input",{type:"url",value:z,onChange:a=>A(a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border text-gray-900",placeholder:"https://yourcompany.atlassian.net"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,b.jsx)("input",{type:"email",value:B,onChange:a=>C(a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border text-gray-900",placeholder:"your-email@company.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"API Token"}),(0,b.jsx)("input",{type:"password",value:D,onChange:a=>E(a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border text-gray-900",placeholder:"Generate at id.atlassian.com"}),(0,b.jsxs)("p",{className:"mt-1 text-xs text-gray-500",children:["Generate at: ",(0,b.jsx)("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:underline",children:"id.atlassian.com/manage-profile/security/api-tokens"})]})]}),(0,b.jsx)("button",{onClick:R,className:"w-full rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white hover:bg-blue-500",children:"Test Connection"}),L&&(0,b.jsx)("div",{className:`rounded-md p-4 ${L.success?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:(0,b.jsx)("p",{className:"text-sm font-medium",children:L.success?`✓ Connected as ${L.user?.displayName}`:`✗ ${L.error}`})}),H.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Project"}),(0,b.jsxs)("select",{value:F,onChange:a=>G(a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border text-gray-900",children:[(0,b.jsx)("option",{value:"",children:"Select a project"}),H.map(a=>(0,b.jsxs)("option",{value:a.key,children:[a.name," (",a.key,")"]},a.key))]})]})]})})}),(0,b.jsx)(l.Tab.Panel,{children:J?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:"Field Configuration"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{htmlFor:"issueType",className:"text-sm font-medium text-gray-700",children:"Issue Type:"}),(0,b.jsx)("select",{id:"issueType",value:N,onChange:a=>O(a.target.value),className:"block w-48 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-1.5 text-gray-900",children:Object.keys(J).map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]})]}),N&&J[N]&&(0,b.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg max-h-96 overflow-y-auto",children:(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,b.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 w-3/4",children:"Field Name"}),(0,b.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 w-1/4",children:"Include"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:Object.entries(J[N].fields).sort(([,a],[,b])=>a.required!==b.required?a.required?-1:1:a.name.localeCompare(b.name)).map(([a,c])=>{let d=c.required,e=!1!==c.included;return(0,b.jsxs)("tr",{className:d?"bg-gray-50":"",children:[(0,b.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{children:c.name}),(0,b.jsx)("span",{className:"text-xs text-gray-500 font-normal",children:a})]})}),(0,b.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-center",children:(0,b.jsx)("input",{type:"checkbox",checked:d||e,disabled:d,onChange:b=>{var c;return c=b.target.checked,void K(b=>({...b,[N]:{...b[N],fields:{...b[N].fields,[a]:{...b[N].fields[a],included:c}}}}))},className:`h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600 ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}`})})]},a)})})]})})]}):(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("p",{className:"text-gray-500",children:"Please configure and test your connection first to load field configurations."})})})]})]}),(0,b.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,b.jsx)("button",{onClick:S,className:"flex-1 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white hover:bg-indigo-500",children:"Save Configuration"}),(0,b.jsx)("button",{onClick:()=>s(!1),className:"flex-1 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"})]})]})})})})]})})]})}a.s(["default",()=>m],63765)}];

//# sourceMappingURL=app_connections_page_tsx_1f3635cf._.js.map